# HybridIdP Deployment Environment Variables

# ASP.NET Core Environment
ASPNETCORE_ENVIRONMENT=Production

# Database Provider: SqlServer or PostgreSQL
DATABASE_PROVIDER=SqlServer

# Database Connection Strings
# Update these with your actual database credentials
# For External DB: Replace 'mssql-service' or 'postgres-service' with remote host/IP.
ConnectionStrings__SqlServerConnection=Server=mssql-service;Database=HybridAuthIdP;User Id=sa;Password=YourStrong!Passw0rd;TrustServerCertificate=True;
ConnectionStrings__PostgreSqlConnection=Host=postgres-service;Port=5432;Database=hybridauth_idp;Username=user;Password=password;
ConnectionStrings__RedisConnection=redis-service:6379

# Database Credentials (for container initialization)
MSSQL_SA_PASSWORD=YourStrong!Passw0rd
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=hybridauth_idp

# Redis Configuration
Redis__Enabled=true

# Proxy Configuration (Internal Mode / Nginx)
# Set to 'true' if running behind Nginx or Load Balancer
Proxy__Enabled=true
# Trusted Proxies (IPs or CIDR ranges, separate by semicolon)
Proxy__KnownProxies=172.16.0.0/12;192.168.0.0/16;10.0.0.0/8

# Certificates
# Paths inside the container (mounted via volumes)
ENCRYPTION_CERT_PASSWORD=changeit
SIGNING_CERT_PASSWORD=changeit

# Turnstile Configuration (Optional - overrides appsettings.json)
# Use double underscore (__) for nested keys
# Turnstile__SiteKey=0x4AAAAAAABBBBBBBB
# Turnstile__SecretKey=0x4AAAAAAABBBBBBBB

# Legacy Authentication (Required for migration scenarios)
LegacyAuth__LoginUrl=https://legacy-system.internal/api/authenticate/login
LegacyAuth__Secret=ChangeThisToYourStrongLegacySecret

# Email Settings (SMTP)
EmailSettings__SmtpHost=smtp.example.com
EmailSettings__SmtpPort=587
EmailSettings__SmtpEnableSsl=true
EmailSettings__SmtpUsername=user@example.com
EmailSettings__SmtpPassword=secret
EmailSettings__FromAddress=noreply@example.com
EmailSettings__FromName=HybridIdP

# Token Security Options
TokenOptions__AccessTokenLifetimeMinutes=15
TokenOptions__RefreshTokenLifetimeMinutes=20160
# RefreshToken Reuse Leeway (Seconds): Default 60. Set to 0 for strict security.
TokenOptions__RefreshTokenReuseLeewaySeconds=60

# Rate Limiting (Production Defaults)
RateLimiting__Enabled=true
RateLimiting__LoginPermitLimit=5
RateLimiting__LoginWindowSeconds=60
