# HybridIdP Deployment Environment Variables

# ASP.NET Core Environment
ASPNETCORE_ENVIRONMENT=Production

# Database Provider: SqlServer or PostgreSQL
DATABASE_PROVIDER=SqlServer

# Database Connection Strings
# Update these with your actual database credentials
# For External DB: Replace 'mssql-service' or 'postgres-service' with remote host/IP.
ConnectionStrings__SqlServerConnection=Server=mssql-service;Database=HybridAuthIdP;User Id=sa;Password=YourStrong!Passw0rd;TrustServerCertificate=True;
ConnectionStrings__PostgreSqlConnection=Host=postgres-service;Port=5432;Database=hybridauth_idp;Username=user;Password=password;
ConnectionStrings__RedisConnection=redis-service:6379

# Database Credentials (for container initialization)
MSSQL_SA_PASSWORD=YourStrong!Passw0rd
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=hybridauth_idp

# Redis Configuration
Redis__Enabled=true

# Proxy Configuration (Internal Mode / Nginx)
# Set to 'true' if running behind Nginx or Load Balancer
Proxy__Enabled=true
# Trusted Proxies (IPs or CIDR ranges, separate by semicolon)
Proxy__KnownProxies=172.16.0.0/12;192.168.0.0/16;10.0.0.0/8

# Split-Host Deployment (docker-compose.splithost.yml)
# INTERNAL_IP: This host's internal IP (binds ports to this IP only)
# PROXY_HOST_IP: IP of the reverse proxy host (for Proxy__KnownProxies)
# INTERNAL_IP=192.168.1.20
# PROXY_HOST_IP=192.168.1.10

# OpenIddict Issuer (Optional)
# If set, tokens will have a fixed issuer URI instead of using the request URL.
# Recommended for production when behind a reverse proxy.
# OpenIddict__Issuer=https://idp.example.com/

# Fido2 / WebAuthn Configuration
# ServerName: The name displayed in the passkey dialog (e.g., "NCUT Identity").
# If not set, falls back to Branding__AppName, then "HybridIdP".
Fido2__ServerName=HybridAuth
# ServerDomain: The effective domain (e.g., idp.example.com)
Fido2__ServerDomain=localhost
# Origins: Comma-separated list of allowed origins
Fido2__Origins=https://localhost:7035
# TimestampDriftTolerance: Time in milliseconds
Fido2__TimestampDriftTolerance=300000

# Branding Configuration
Branding__AppName=HybridAuth
Branding__ProductName='HybridAuth IdP'
Branding__Copyright='Â© 2025'
# Branding__PoweredBy=MyCompany

# Certificates
# Paths inside the container (mounted via volumes)
ENCRYPTION_CERT_PASSWORD=changeit
SIGNING_CERT_PASSWORD=changeit

# Turnstile Configuration (Optional - overrides appsettings.json)
# Use double underscore (__) for nested keys
# Turnstile__SiteKey=0x4AAAAAAABBBBBBBB
# Turnstile__SecretKey=0x4AAAAAAABBBBBBBB

# Legacy Authentication (Required for migration scenarios)
LegacyAuth__LoginUrl=https://legacy-system.internal/api/authenticate/login
LegacyAuth__Secret=ChangeThisToYourStrongLegacySecret

# Email Settings (SMTP)
EmailSettings__SmtpHost=smtp.example.com
EmailSettings__SmtpPort=587
EmailSettings__SmtpEnableSsl=true
EmailSettings__SmtpUsername=user@example.com
EmailSettings__SmtpPassword=secret
EmailSettings__FromAddress=noreply@example.com
EmailSettings__FromName=HybridIdP

# Token Security Options
TokenOptions__AccessTokenLifetimeMinutes=15
TokenOptions__RefreshTokenLifetimeMinutes=20160
# RefreshToken Reuse Leeway (Seconds): Default 60. Set to 0 for strict security.
TokenOptions__RefreshTokenReuseLeewaySeconds=60

# Rate Limiting (Production Defaults)
RateLimiting__Enabled=true
RateLimiting__LoginPermitLimit=5
RateLimiting__LoginWindowSeconds=60

# Observability / OpenTelemetry
# Set to true to enable OpenTelemetry tracing (useful for production monitoring)
# Observability__Enabled=true

# Logging Level (Default: Warning)
# Set to Information or Debug for troubleshooting
# Logging__LogLevel__Default=Information
# Logging__LogLevel__Microsoft.EntityFrameworkCore=Information

# Login Page Notices (Optional)
# Display custom messages on the login page at 3 positions: Top, Form, Bottom
# Type can be: info, warning, success, error, muted
# Use @Key syntax to load from localization DB, e.g. @LoginNotice.Top
# LoginNotices__TopMessage=ðŸ”§ System maintenance scheduled for 12/25
# LoginNotices__TopType=warning
# LoginNotices__FormMessage=Please use your company email to sign in
# LoginNotices__FormType=info
# LoginNotices__BottomMessage=Need help? Contact IT: helpdesk@company.com
# LoginNotices__BottomType=muted
